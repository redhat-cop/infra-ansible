---

- name: "Build DNS nameservers command line options"
  set_fact:
    dns_nameservers: "{{ dns_nameservers | default('') + ' --dns-nameserver ' + item }}"
  with_items:
  - "{{ subnet.dns_nameservers }}"

- name: "Set up subnet"
  shell: >
    openstack subnet create \
      --network "{{ subnet.network }}" \
      --allocation-pool "{{ subnet.allocation_pool }}" \
      {{ dns_nameservers }} \
      --{{ subnet.dhcp_option | default('dhcp') }} \
      --subnet-range "{{ subnet.subnet_range }}" \
      --gateway "{{ subnet.gateway }}" \
      "{{ subnet.name }}"
