---
- name: "Remove records in Private zone"
  route53:
    aws_access_key: "{{ aws_access_key }}"
    aws_secret_key: "{{ aws_secret_key }}"
    state: absent
    zone: "{{ item.zone }}"
    private_zone: "true"
    vpc_id: "{{ item.route53.vpc_id }}"
    value: "{{ r53_record.1.Value }}"
    record: "{{ r53_record.0.Name }}"
    ttl: "{{ r53_record.0.TTL }}"
    type: "{{ r53_record.0.Type }}"
  with_items: 
    - "{{ dns_data }}"
  when: (item.state == "absent") and
        (item.zone + "." == r53_zone.item.Name) and
        (item.view == "private") and
        ((r53_record.0.Name != r53_zone.item.Name) and
        (r53_record.0.Type != "SOA") and
        (r53_record.0.Type != "NS"))

- name: "Remove records in Public zone"
  route53:
    aws_access_key: "{{ aws_access_key }}"
    aws_secret_key: "{{ aws_secret_key }}"
    state: absent
    zone: "{{ item.zone }}"
    record: "{{ r53_record.0.Name }}"
    ttl: "{{ r53_record.0.TTL }}"
    value: "{{ r53_record.1.Value }}" 
    type: "{{ r53_record.0.Type }}"
  with_items: 
    - "{{ dns_data }}"
  when: (item.state == "absent") and
        (item.zone + "." == r53_zone.item.Name) and
        (item.view == "public") and
        ((r53_record.0.Name != r53_zone.item.Name) and
        (r53_record.0.Type != "SOA") and
        (r53_record.0.Type != "NS"))

