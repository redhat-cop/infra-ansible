---

- name: Update the private zone
  route53_zone:
    aws_access_key: "{{ aws_access_key }}"
    aws_secret_key: "{{ aws_secret_key }}"
    zone: "{{ item.zone }}"
    vpc_id: "{{ item.route53.vpc_id }}"
    vpc_region: "{{ item.route53.vpc_region }}"
    state: "{{ item.state | default('present') }}"
  with_items:
    - "{{ dns_data | default({}) }}"
  when:
    - item.view == "private"

- name: Ensure the public zone does not exist
  route53_zone:
    aws_access_key: "{{ aws_access_key }}"
    aws_secret_key: "{{ aws_secret_key }}"
    zone: "{{ item.zone }}"
    state: "{{ item.state | default('present') }}"
  with_items:
    - "{{ dns_data | default({}) }}"
  when:
    - item.view == "public"
